
{% extends 'base.html' %}
{% block title %}Edition View{% endblock %}

{% block content %}
<h1>{{ edition_name }}</h1>
{% if edition_info.icon_svg_uri %}
    <img src="{{ edition_info.icon_svg_uri }}" alt="{{ edition_name }} icon" style="width: 100px;">
{% endif %}

<div>
    <form action="{{ url_for('edition_view', edition_name=edition_name) }}" method="get" class="filter-form">
        <div class="form-group">
            <label for="color">Color:</label>
            <select name="color" id="color" class="form-control">
                <option value="">All</option>
                <option value="W" {% if request.args.get('color') == 'W' %}selected{% endif %}>White</option>
                <option value="U" {% if request.args.get('color') == 'U' %}selected{% endif %}>Blue</option>
                <option value="B" {% if request.args.get('color') == 'B' %}selected{% endif %}>Black</option>
                <option value="R" {% if request.args.get('color') == 'R' %}selected{% endif %}>Red</option>
                <option value="G" {% if request.args.get('color') == 'G' %}selected{% endif %}>Green</option>
            </select>
        </div>
        <div class="form-group">
            <label for="rarity">Rarity:</label>
            <select name="rarity" id="rarity" class="form-control">
                <option value="">All</option>
                <option value="Common" {% if request.args.get('rarity') == 'Common' %}selected{% endif %}>Common</option>
                <option value="Uncommon" {% if request.args.get('rarity') == 'Uncommon' %}selected{% endif %}>Uncommon</option>
                <option value="Rare" {% if request.args.get('rarity') == 'Rare' %}selected{% endif %}>Rare</option>
                <option value="Mythic" {% if request.args.get('rarity') == 'Mythic' %}selected{% endif %}>Mythic</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Filter</button>
    </form>
</div>

<div id="cards-container" class="card-grid">
    {% for card in cards %}
    <div class="card" data-collector-number="{{ card.collector_number }}" data-colors="{{ card.colors | join(' ') }}" data-rarity="{{ card.rarity }}" data-name="{{ card.name }}">
        <img src="{{ url_for('card_image', edition_name=edition_name, scryfall_id=card.scryfall_id) }}" alt="Image of {{ card.name }}" class="card-image">
        <div class="card-details">
            <div class="card-name-collector">
                <div class="card-name">{{ card.name }}</div>
                <div class="card-collector-number">#{{ card.collector_number }}</div>
            </div>
            <div class="quantities">
                <div class="quantity-detail">
                    <span class="qty-label">Foil:</span>
                    <span class="qty-number">{{ card.collections[0].quantity_foil if card.collections else 0 }}</span>
                </div>
                <div class="quantity-detail">
                    <span class="qty-label">Non-Foil:</span>
                    <span class="qty-number">{{ card.collections[0].quantity_nonfoil if card.collections else 0 }}</span>
                </div>
            </div>
            <div class="prices">
                <div class="price-detail">
                    <span class="price-label">Foil Price:</span>
                    <span class="price-amount">${{ card.prices['usd_foil'] if 'usd_foil' in card.prices else 'N/A' }}</span>
                </div>
                <div class="price-detail">
                    <span class="price-label">Non-Foil Price:</span>
                    <span class="price-amount">${{ card.prices['usd'] if 'usd' in card.prices else 'N/A' }}</span>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}
